<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Peti Game</title>

<style>
body{
    margin:0;
    font-family:'Segoe UI', sans-serif;
    background:black;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    height:100vh;
}
.container{
    display:flex;
    gap:18px;
    margin-bottom:20px;
}
.peti{
    width:80px;
    height:80px;
    perspective:900px;
    cursor:pointer;
    animation: idleFloat 2.4s ease-in-out infinite;
}
.peti-inner{
    width:100%;
    height:100%;
    position:relative;
    transform-style:preserve-3d;
    transition:transform .6s;
}
.peti.terbuka .peti-inner{ transform:rotateY(180deg); }

.peti-front,.peti-back{
    position:absolute;
    width:100%;
    height:100%;
    backface-visibility:hidden;
    border-radius:12px;
    display:flex;
    justify-content:center;
    align-items:center;
}
.peti-front img{ width:100%; height:100%; object-fit:contain; }
.peti-back{ background:#444; transform:rotateY(180deg); }
.peti.harta .peti-back{
    background:#ffd700;
    box-shadow:0 0 25px rgba(255,215,0,.9);
}
@keyframes idleFloat{
    0%,100%{ transform:translateY(0) }
    50%{ transform:translateY(-10px) }
}
button{
    padding:10px 26px;
    background:#e94560;
    color:white;
    border:none;
    border-radius:6px;
    cursor:pointer;
}
</style>
</head>

<body>

<div class="container">
    <div class="peti" onclick="bukaPeti(0)"><div class="peti-inner"><div class="peti-front"><img src="peti.png"></div><div class="peti-back"></div></div></div>
    <div class="peti" onclick="bukaPeti(1)"><div class="peti-inner"><div class="peti-front"><img src="peti.png"></div><div class="peti-back"></div></div></div>
    <div class="peti" onclick="bukaPeti(2)"><div class="peti-inner"><div class="peti-front"><img src="peti.png"></div><div class="peti-back"></div></div></div>
    <div class="peti" onclick="bukaPeti(3)"><div class="peti-inner"><div class="peti-front"><img src="peti.png"></div><div class="peti-back"></div></div></div>
    <div class="peti" onclick="bukaPeti(4)"><div class="peti-inner"><div class="peti-front"><img src="peti.png"></div><div class="peti-back"></div></div></div>
</div>

<button onclick="resetGame()">Ulang</button>

<!-- SOUND -->
<audio id="soundZonk" src="wkwk.mp3"></audio>
<audio id="soundSCTB" src="sctb1.mp3"></audio>
<audio id="soundRuby" src="kraken.mp3"></audio>

<script>
// suara SCTB 1 detik
function playSound1Detik(audio){
    audio.currentTime = 0;
    audio.play();
    setTimeout(()=>{
        audio.pause();
        audio.currentTime = 0;
    },1000);
}

let hadiah = Array(5).fill(null);
let klikKe = 0;

function acakArray(arr){
    return arr.sort(()=>Math.random()-0.5);
}

function bukaPeti(index){
    const peti = document.querySelectorAll('.peti');
    const back = peti[index].querySelector('.peti-back');
    if(peti[index].classList.contains('terbuka')) return;

    peti[index].classList.add('terbuka');
    klikKe++;

    setTimeout(()=>{
        // ===== KLIK PERTAMA (TANPA RUBY) =====
        if(klikKe === 1){
            const pilihanAwal = acakArray([
                {type:'zonk', img:'zonk.png', sound:soundZonk},
                {type:'sctb', img:'sc_tb.png', sound:soundSCTB},
                {type:'zonk', img:'zonk.png', sound:soundZonk},
                {type:'sctb', img:'sc_tb.png', sound:soundSCTB},
            ]);

            const h = pilihanAwal.pop();
            hadiah[index] = h;

            // siapkan sisa hadiah + 1 ruby
            let sisa = [
                ...pilihanAwal,
                {type:'ruby', img:'rubydino.png', sound:soundRuby}
            ];

            // isi hadiah untuk peti lain
            acakArray(sisa);
            peti.forEach((p,i)=>{
                if(i !== index){
                    hadiah[i] = sisa.pop();
                }
            });

            tampilkanHadiah(h, back, peti[index]);
            return;
        }

        // ===== KLIK SELANJUTNYA =====
        const h = hadiah[index];
        tampilkanHadiah(h, back, peti[index]);

    },350);
}

function tampilkanHadiah(h, back, peti){
    back.innerHTML = `<img src="${h.img}" width="60">`;
    if(h.type !== 'zonk') peti.classList.add('harta');

    if(h.type === 'sctb'){
        playSound1Detik(soundSCTB);
    }else{
        h.sound.play();
    }
}

function resetGame(){
    const peti = document.querySelectorAll('.peti');
    hadiah = Array(5).fill(null);
    klikKe = 0;
    peti.forEach(p=>{
        p.classList.remove('terbuka','harta');
        p.querySelector('.peti-back').innerHTML = '';
    });
}
</script>

</body>
</html>
